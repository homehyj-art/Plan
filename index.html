<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아틀란티스의 지혜: 나의 진로 모험</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #0d1a2a;
            color: #e0e0e0;
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
        }
        
        #game-container {
            width: 90%;
            max-width: 1200px;
            height: 90vh;
            max-height: 800px;
            background: rgba(2, 6, 17, 0.7);
            border: 5px solid #ffcc00;
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(255, 204, 0, 0.5);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
        }

        #bg-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
            opacity: 0.3;
        }
        
        h1, h2 {
            color: #ffcc00;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        
        #start-screen, #character-select-screen, #quest-screen, #result-screen, #dashboard-screen {
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        
        .visible {
            display: flex !important;
            opacity: 1 !important;
        }
        
        .button {
            padding: 15px 30px;
            font-size: 1.2em;
            cursor: pointer;
            border: 2px solid #ffcc00;
            border-radius: 10px;
            background: linear-gradient(45deg, #0f2027, #2c5364);
            color: #fff;
            margin: 10px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px #ffcc00;
        }
        
        #character-list {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .character-card {
            background-color: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            width: 180px;
            text-align: center;
        }
        
        .character-card img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 3px solid #ffcc00;
            object-fit: cover;
        }
        
        .character-card.selected {
            border-color: #00ff00;
            box-shadow: 0 0 20px #00ff00;
            transform: scale(1.1);
        }
        
        .character-card h3 {
            color: #ffcc00;
            margin: 10px 0;
        }
        
        .character-card p {
            font-size: 0.9em;
            color: #ccc;
        }

        #quest-text {
            font-size: 1.5em;
            margin: 20px;
            text-align: center;
        }

        #quest-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 80%;
        }

        .quest-option {
            padding: 15px;
            font-size: 1.1em;
            border: 1px solid #aaa;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
            background-color: #2b2b2b;
        }
        
        .quest-option:hover {
            background-color: #444;
            transform: translateY(-3px);
        }
        
        #progress-bar-container {
            width: 80%;
            background-color: #555;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
        }

        #progress-bar {
            height: 20px;
            background-color: #00ff00;
            width: 0%;
            transition: width 0.5s ease-in-out;
            text-align: center;
            line-height: 20px;
            color: #fff;
        }

        #result-content {
            font-size: 1.2em;
            margin: 20px;
        }

        #dashboard-content {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
        }

        #dashboard-content table {
            width: 100%;
            border-collapse: collapse;
        }
        
        #dashboard-content th, #dashboard-content td {
            border: 1px solid #fff;
            padding: 10px;
            text-align: left;
        }

        .fade-out {
            opacity: 0;
            transition: opacity 1s;
        }
        .fade-in {
            opacity: 1;
            transition: opacity 1s;
        }

        .emoji {
            font-size: 2em;
        }
        
        .star-burst {
            animation: sparkle 0.8s ease-out forwards;
        }
        
        @keyframes sparkle {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 0.5; }
        }

    </style>
</head>
<body>
    <video id="bg-video" autoplay muted loop>
        <source src="https://assets.mixkit.co/videos/preview/mixkit-floating-lights-in-an-ocean-4067-large.mp4" type="video/mp4">
    </video>

    <div id="game-container">
        <div id="start-screen" class="visible">
            <h1>잃어버린 지혜를 찾아서</h1>
            <p>고대 아틀란티스 대륙에서 당신의 숨겨진 잠재력을 발견하세요!</p>
            <button class="button" id="start-btn">모험 시작하기</button>
        </div>

        <div id="character-select-screen">
            <h2>캐릭터 선택</h2>
            <p>당신의 모험을 함께할 캐릭터를 선택하세요. 캐릭터마다 다른 모험이 펼쳐집니다!</p>
            <div id="character-list">
                <div class="character-card" data-character="scholar">
                    <img src="https://via.placeholder.com/100/ffcc00/000000?text=학자" alt="고대 학자">
                    <h3>고대 학자</h3>
                    <p>지혜의 문헌을 해독하며 지식의 길을 여는 탐험가</p>
                </div>
                <div class="character-card" data-character="shaman">
                    <img src="https://via.placeholder.com/100/2ecc71/000000?text=정령술사" alt="정령술사">
                    <h3>정령술사</h3>
                    <p>자연의 힘과 교감하며 숨겨진 비밀을 밝히는 자</p>
                </div>
                <div class="character-card" data-character="warrior">
                    <img src="https://via.placeholder.com/100/e74c3c/000000?text=싸움꾼" alt="싸움꾼">
                    <h3>싸움꾼</h3>
                    <p>강인한 신체와 용기로 어떤 난관도 헤쳐나가는 전사</p>
                </div>
                <div class="character-card" data-character="artist">
                    <img src="https://via.placeholder.com/100/9b59b6/000000?text=예술가" alt="예술가">
                    <h3>예술가</h3>
                    <p>아름다운 음악과 그림으로 세상을 물들이는 창조자</p>
                </div>
            </div>
            <button class="button" id="select-char-btn" disabled>선택 완료</button>
        </div>

        <div id="quest-screen">
            <h2 id="quest-title"></h2>
            <p id="quest-story"></p>
            <div id="quest-text"></div>
            <div id="quest-options"></div>
            <div id="progress-bar-container">
                <div id="progress-bar">0%</div>
            </div>
        </div>

        <div id="result-screen">
            <h2>모험 완료!</h2>
            <p>축하합니다! 당신의 모험이 끝났습니다. 당신의 강점 지능은 바로...</p>
            <div id="result-content"></div>
            <button class="button" id="restart-btn">다시 시작하기</button>
            <button class="button" id="dashboard-btn">교사 대시보드 보기</button>
        </div>

        <div id="dashboard-screen">
            <h2>교사 대시보드</h2>
            <div id="dashboard-content">
                <p>로딩 중...</p>
            </div>
            <button class="button" id="back-to-home-btn">처음으로</button>
        </div>
    </div>

    <audio id="bgm" loop>
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-ancient-forest-soundscape-2067.mp3" type="audio/mpeg">
    </audio>

    <script>
        const gameContainer = document.getElementById('game-container');
        const startScreen = document.getElementById('start-screen');
        const characterSelectScreen = document.getElementById('character-select-screen');
        const questScreen = document.getElementById('quest-screen');
        const resultScreen = document.getElementById('result-screen');
        const dashboardScreen = document.getElementById('dashboard-screen');
        const startBtn = document.getElementById('start-btn');
        const characterCards = document.querySelectorAll('.character-card');
        const selectCharBtn = document.getElementById('select-char-btn');
        const questTitle = document.getElementById('quest-title');
        const questStory = document.getElementById('quest-story');
        const questText = document.getElementById('quest-text');
        const questOptions = document.getElementById('quest-options');
        const progressBar = document.getElementById('progress-bar');
        const resultContent = document.getElementById('result-content');
        const restartBtn = document.getElementById('restart-btn');
        const dashboardBtn = document.getElementById('dashboard-btn');
        const backToHomeBtn = document.getElementById('back-to-home-btn');
        const bgm = document.getElementById('bgm');

        let currentScreen = 'start';
        let selectedCharacter = null;
        let questIndex = 0;
        let scores = { '언어지능': 0, '논리수학지능': 0, '공간지능': 0, '신체운동지능': 0, '음악지능': 0, '대인관계지능': 0, '개인내적지능': 0, '자연주의지능': 0 };
        const totalQuests = 20;
        let studentResults = []; // 교사 대시보드용 데이터

        // 모든 캐릭터가 공유하는 공통 퀘스트 목록
        const allQuests = [
            { title: '잃어버린 고대어 해독', text: '오래된 비석에 알 수 없는 언어가 새겨져 있어요. 비문을 해독해 다음 장소의 힌트를 얻으세요.', options: ['단어를 조합하여 문장 완성하기 (언어지능 +1)', '비석의 기하학적 패턴 분석하기 (논리수학지능 +1)'], correct: 0 },
            { title: '미궁의 논리 퍼즐', text: '앞으로 나아가려면 3개의 논리 퍼즐을 풀어야 합니다. 정확한 답을 찾아 길을 여세요.', options: ['수열의 규칙 찾기 (논리수학지능 +1)', '문맥상 어색한 단어 찾기 (언어지능 +1)'], correct: 0 },
            { title: '나무 정령과의 교감', text: '슬픔에 빠진 나무 정령이 울고 있어요. 정령을 달래서 숲의 길을 열어주세요.', options: ['나무의 나이테를 세어보기 (자연주의지능 +1)', '마음으로 정령의 감정 느끼기 (개인내적지능 +1)'], correct: 1 },
            { title: '숨겨진 동굴 지도 그리기', text: '복잡한 동굴을 통과해야 해요. 기억력을 동원해 정확한 지도를 그려 출구를 찾으세요.', options: ['동굴의 구조를 시각화하기 (공간지능 +1)', '동굴의 환경적 특징 기록하기 (자연주의지능 +1)'], correct: 0 },
            { title: '폭포 오르기', text: '가파른 폭포를 올라가야 합니다. 강인한 체력을 이용해 폭포를 등반하세요!', options: ['올라가는 방법을 계획하고 실행하기 (신체운동지능 +1)', '체력의 한계를 극복하며 자신에게 집중하기 (개인내적지능 +1)'], correct: 0 },
            { title: '거울의 방 탈출', text: '자신과 똑같은 거울 속 분신과 마주했어요. 분신의 움직임을 예측해 방을 탈출하세요.', options: ['분신의 움직임을 따라하며 예측하기 (신체운동지능 +1)', '자신의 마음을 들여다보며 평정심 유지하기 (개인내적지능 +1)'], correct: 1 },
            { title: '하프의 조각 맞추기', text: '부서진 하프를 연주해야 해요. 하프의 조각을 올바른 순서로 맞춰보세요.', options: ['조각의 모양과 위치를 파악하기 (공간지능 +1)', '음의 높낮이를 상상하며 조각 배치하기 (음악지능 +1)'], correct: 1 },
            { title: '마을 사람들의 축제 돕기', text: '마을 축제에 활기가 없어요. 사람들과 함께 힘을 합쳐 즐거운 축제를 만들어주세요.', options: ['음악을 만들어 축제의 분위기 띄우기 (음악지능 +1)', '마을 사람들과 소통하며 역할 분담하기 (대인관계지능 +1)'], correct: 1 },
            // 나머지 12개의 퀘스트는 이 곳에 추가 (총 20개)
            { title: '어둠의 동굴에서 길 찾기', text: '어둠 속에서 길을 찾아야 합니다. 주변 환경을 잘 살펴서 나아가세요.', options: ['바닥의 흙 냄새로 방향을 찾기 (자연주의지능 +1)', '미세한 소리를 듣고 길의 방향 예측하기 (음악지능 +1)'], correct: 1 },
            { title: '위험한 강 건너기', text: '강을 건너야 하지만 다리가 부서졌습니다. 직접 건너는 방법을 찾아보세요.', options: ['가장 빠른 유속을 계산하여 뛰어 건너기 (논리수학지능 +1)', '강 주변의 덩굴을 이용해 밧줄 만들기 (신체운동지능 +1)'], correct: 1 },
            { title: '환상의 숲에서 탈출', text: '숲의 환술에 걸려 길을 잃었어요. 이성적으로 생각해서 탈출하세요.', options: ['환술의 패턴을 분석하여 규칙 찾기 (논리수학지능 +1)', '숲속의 동식물과 대화하며 탈출구 찾기 (대인관계지능 +1)'], correct: 0 },
            { title: '고대 석상과의 대화', text: '말을 하지 않는 고대 석상이 수수께끼를 던집니다. 석상의 의도를 파악하세요.', options: ['석상의 표정을 보고 감정 읽어내기 (대인관계지능 +1)', '석상이 던진 수수께끼를 논리적으로 풀기 (논리수학지능 +1)'], correct: 1 },
            { title: '잃어버린 노래 찾기', text: '잃어버린 아틀란티스 대륙의 노래를 찾아야 합니다. 노래를 복원해 보세요.', options: ['흩어진 악보 조각을 맞춰보기 (음악지능 +1)', '악보의 역사적 의미를 파악하기 (언어지능 +1)'], correct: 0 },
            { title: '마음의 숲길 걷기', text: '당신의 마음속으로 들어와 깊은 숲길을 걷게 되었습니다. 자신의 감정을 다루어야 합니다.', options: ['불안한 감정에 솔직하게 마주하기 (개인내적지능 +1)', '마음의 숲 지형을 상상하며 길 찾아가기 (공간지능 +1)'], correct: 0 },
            { title: '신비한 동식물 분류', text: '신비한 동식물들이 가득한 정원에서 길을 잃었어요. 이들을 분류해 질서를 찾아야 합니다.', options: ['동식물의 특성을 파악해 그룹으로 나누기 (자연주의지능 +1)', '동식물과 소통해 길을 묻기 (대인관계지능 +1)'], correct: 0 },
            { title: '무용수와 춤추기', text: '길을 열어주는 무용수와 함께 춤을 추어야 합니다. 무용수의 동작을 완벽히 따라하세요.', options: ['동작의 순서를 외우고 따라하기 (신체운동지능 +1)', '무용수의 춤에 숨겨진 이야기를 파악하기 (언어지능 +1)'], correct: 0 },
            { title: '신전의 보물 지도 그리기', text: '신전 안의 보물 지도가 사라졌어요. 지도를 상상해서 다시 그려야 합니다.', options: ['신전의 구조를 기억하며 길 그리기 (공간지능 +1)', '보물의 역사적 가치를 떠올리며 그리기 (개인내적지능 +1)'], correct: 0 },
            { title: '전설의 무기 만들기', text: '잃어버린 무기를 만들기 위한 재료를 모아야 합니다. 재료를 조합해 무기를 만드세요.', options: ['재료의 화학적 반응을 고려해 조합하기 (논리수학지능 +1)', '재료의 특성을 느끼고 본능적으로 조합하기 (신체운동지능 +1)'], correct: 0 },
            { title: '고대 문서 복원', text: '고대 문서가 심하게 훼손되었습니다. 문서를 복원해 다음 퀘스트의 힌트를 얻으세요.', options: ['문서에 사용된 언어의 특징을 파악해 빈칸 채우기 (언어지능 +1)', '문서의 훼손된 부분을 퍼즐처럼 맞춰 복원하기 (공간지능 +1)'], correct: 0 },
            { title: '사냥꾼 길들이기', text: '사나운 사냥꾼이 길을 막고 있습니다. 사냥꾼의 마음을 얻어 길을 비켜달라고 하세요.', options: ['사냥꾼이 좋아하는 노래를 불러주기 (음악지능 +1)', '사냥꾼의 분노 원인을 분석하고 위로하기 (대인관계지능 +1)'], correct: 1 }
        ];

        const characterData = {
            scholar: { name: '고대 학자' },
            shaman: { name: '정령술사' },
            warrior: { name: '싸움꾼' },
            artist: { name: '예술가' }
        };

        const intelligenceInfo = {
            '언어지능': { title: '언어지능', desc: '말과 글을 통해 자신의 생각을 표현하고 이해하는 능력', emoji: '✍️' },
            '논리수학지능': { title: '논리수학지능', desc: '논리적인 문제 해결, 패턴 인식, 추리 능력', emoji: '🤔' },
            '공간지능': { title: '공간지능', desc: '공간, 형태, 이미지를 시각적으로 파악하고 다루는 능력', emoji: '🗺️' },
            '신체운동지능': { title: '신체운동지능', desc: '신체를 자유자재로 다루고 표현하는 능력', emoji: '🏃' },
            '음악지능': { title: '음악지능', desc: '음악적 패턴을 인식하고 창조하는 능력', emoji: '🎵' },
            '대인관계지능': { title: '대인관계지능', desc: '타인의 감정, 의도를 이해하고 소통하는 능력', emoji: '👥' },
            '개인내적지능': { title: '개인내적지능', desc: '자신의 감정, 목표, 강점을 이해하는 능력', emoji: '🧘' },
            '자연주의지능': { title: '자연주의지능', desc: '자연 환경의 특징을 인식하고 분류하는 능력', emoji: '🌳' }
        };

        const playBGM = () => {
            bgm.volume = 0.5;
            bgm.play();
        };

        const stopBGM = () => {
            bgm.pause();
            bgm.currentTime = 0;
        };

        const switchScreen = (from, to) => {
            document.getElementById(from).classList.remove('visible');
            setTimeout(() => {
                document.getElementById(to).classList.add('visible');
            }, 500);
        };

        const startGame = () => {
            switchScreen('start-screen', 'character-select-screen');
            playBGM();
        };

        const selectCharacter = (e) => {
            const card = e.currentTarget;
            characterCards.forEach(c => c.classList.remove('selected'));
            card.classList.add('selected');
            selectedCharacter = card.dataset.character;
            selectCharBtn.disabled = false;
        };

        const startQuest = () => {
            if (!selectedCharacter) return;
            switchScreen('character-select-screen', 'quest-screen');
            questIndex = 0;
            updateQuest();
        };

        const updateQuest = () => {
            if (questIndex >= totalQuests) {
                endGame();
                return;
            }

            const currentQuest = allQuests[questIndex];
            questTitle.textContent = `퀘스트 ${questIndex + 1}/${totalQuests}`;
            questStory.textContent = characterData[selectedCharacter].story || '깊은 바닷속 고대 유적지, 당신의 모험이 시작됩니다.';
            questText.textContent = currentQuest.text;
            questOptions.innerHTML = '';

            currentQuest.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('quest-option');
                button.addEventListener('click', () => handleAnswer(index, currentQuest.correct));
                questOptions.appendChild(button);
            });

            const progress = (questIndex / totalQuests) * 100;
            progressBar.style.width = `${progress}%`;
            progressBar.textContent = `${Math.round(progress)}%`;
        };
        
        const handleAnswer = (selectedIndex, correctIndex) => {
            const options = questOptions.querySelectorAll('.quest-option');
            options.forEach(btn => btn.disabled = true);
            
            const selectedOptionText = options[selectedIndex].textContent;
            const intelligenceType = selectedOptionText.match(/\((.*?)\s*\+1\)/)[1];
            scores[intelligenceType]++;

            questIndex++;
            setTimeout(updateQuest, 1000);
        };

        const endGame = () => {
            const resultList = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const dominantIntelligence = resultList[0][0];
            const dominantScore = resultList[0][1];
            
            resultContent.innerHTML = `
                <p>당신의 강점 지능은 바로 <span style="font-size:1.5em; font-weight:bold; color:#ffcc00;">${intelligenceInfo[dominantIntelligence].title}</span>입니다! 🎉</p>
                <p>${intelligenceInfo[dominantIntelligence].emoji}</p>
                <p>${intelligenceInfo[dominantIntelligence].desc}</p>
                <p>모험을 통해 ${dominantIntelligence}을(를) ${dominantScore}번 발휘했습니다!</p>
            `;
            
            // 대시보드 데이터 저장
            const studentName = prompt("이름을 입력하세요:") || "익명";
            studentResults.push({ name: studentName, character: selectedCharacter, scores: { ...scores } });

            // 스코어 리셋
            scores = { '언어지능': 0, '논리수학지능': 0, '공간지능': 0, '신체운동지능': 0, '음악지능': 0, '대인관계지능': 0, '개인내적지능': 0, '자연주의지능': 0 };

            switchScreen('quest-screen', 'result-screen');
        };

        const showDashboard = () => {
            switchScreen('result-screen', 'dashboard-screen');
            const dashboardContent = document.getElementById('dashboard-content');
            
            if (studentResults.length === 0) {
                dashboardContent.innerHTML = '<p>아직 참여한 학생이 없습니다.</p>';
                return;
            }

            let tableHTML = '<table><thead><tr><th>이름</th><th>캐릭터</th><th>강점 지능</th></tr></thead><tbody>';
            studentResults.forEach(student => {
                const sortedScores = Object.entries(student.scores).sort((a, b) => b[1] - a[1]);
                const dominant = sortedScores[0][0];
                tableHTML += `<tr><td>${student.name}</td><td>${characterData[student.character].name}</td><td>${intelligenceInfo[dominant].title}</td></tr>`;
            });
            tableHTML += '</tbody></table>';
            dashboardContent.innerHTML = tableHTML;
        };

        const restartGame = () => {
            switchScreen('result-screen', 'start-screen');
        };

        const goBackToHome = () => {
            switchScreen('dashboard-screen', 'start-screen');
        };

        startBtn.addEventListener('click', startGame);
        characterCards.forEach(card => card.addEventListener('click', selectCharacter));
        selectCharBtn.addEventListener('click', startQuest);
        restartBtn.addEventListener('click', restartGame);
        dashboardBtn.addEventListener('click', showDashboard);
        backToHomeBtn.addEventListener('click', goBackToHome);
    </script>
</body>
</html>
