import { useState } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";

const scenarios = [
  {
    title: "ì¤‘í•™êµ ì…í•™!",
    description: "ìƒˆë¡œìš´ í™˜ê²½ì—ì„œ ë‚˜ëŠ” ì–´ë–¤ ì„ íƒì„ í• ê¹Œ?",
    choices: [
      { text: "ìƒˆ ì¹œêµ¬ì—ê²Œ ë¨¼ì € ë§ì„ ê±´ë‹¤", effects: { ì¸ê°„ê´€ê³„: +2 } },
      { text: "ì¡°ìš©íˆ ì§€ì¼œë³¸ë‹¤", effects: { ì§€ì‹: +1 } },
    ],
  },
  {
    title: "ì‹œí—˜ ê¸°ê°„, ì¹œêµ¬ê°€ ë†€ìê³  í•œë‹¤!",
    description: "ë‚˜ëŠ” ì–´ë–¤ ì„ íƒì„ í• ê¹Œ?",
    choices: [
      { text: "ê°™ì´ ë…¼ë‹¤", effects: { ì¸ê°„ê´€ê³„: +2, ì§€ì‹: -1 } },
      { text: "ê±°ì ˆí•˜ê³  ê³µë¶€í•œë‹¤", effects: { ì§€ì‹: +2, ì¸ê°„ê´€ê³„: -1 } },
    ],
  },
];

export default function LifeGame() {
  const [step, setStep] = useState(0);
  const [stats, setStats] = useState({ ì§€ì‹: 0, ì²´ë ¥: 0, ì¸ê°„ê´€ê³„: 0, ì¬ëŠ¥: 0 });
  const [showEnding, setShowEnding] = useState(false);

  const current = scenarios[step];

  const handleChoice = (effects) => {
    const newStats = { ...stats };
    for (let key in effects) newStats[key] += effects[key];
    setStats(newStats);

    if (step + 1 < scenarios.length) {
      setStep(step + 1);
    } else {
      setShowEnding(true);
    }
  };

  return (
    <div className="min-h-screen bg-gradient-to-b from-pink-100 to-yellow-100 flex flex-col items-center justify-center p-6">
      <h1 className="text-3xl font-bold mb-4">ğŸŒŸ ì¸ìƒ ì—­ì „! ë¼ì´í”„ ì¹´ë“œ ê²Œì„</h1>

      {/* ëŠ¥ë ¥ì¹˜ í‘œì‹œ */}
      <motion.div
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
        className="grid grid-cols-2 gap-4 mb-6"
      >
        {Object.entries(stats).map(([k, v]) => (
          <motion.div
            key={k}
            animate={{ scale: [1, 1.1, 1] }}
            transition={{ duration: 0.4 }}
            className="bg-white shadow-md rounded-2xl px-4 py-2 text-center"
          >
            {k}: {v}
          </motion.div>
        ))}
      </motion.div>

      <AnimatePresence mode="wait">
        {!showEnding ? (
          <motion.div
            key={step}
            initial={{ opacity: 0, rotateY: 90 }}
            animate={{ opacity: 1, rotateY: 0 }}
            exit={{ opacity: 0, rotateY: -90 }}
            transition={{ duration: 0.6 }}
          >
            <Card className="w-80 bg-white shadow-2xl rounded-2xl">
              <CardContent className="p-6 text-center">
                <h2 className="text-xl font-bold mb-2">{current.title}</h2>
                <p className="mb-4">{current.description}</p>
                {current.choices.map((c, i) => (
                  <motion.div whileHover={{ scale: 1.05 }} whileTap={{ scale: 0.95 }} key={i}>
                    <Button
                      onClick={() => handleChoice(c.effects)}
                      className="w-full mb-2 rounded-xl"
                    >
                      {c.text}
                    </Button>
                  </motion.div>
                ))}
              </CardContent>
            </Card>
          </motion.div>
        ) : (
          <motion.div
            key="ending"
            initial={{ opacity: 0, scale: 0.8 }}
            animate={{ opacity: 1, scale: 1 }}
            transition={{ duration: 0.8 }}
            className="bg-white p-8 rounded-3xl shadow-xl text-center max-w-md"
          >
            <h2 className="text-2xl font-bold mb-4">ğŸ‰ ë‚˜ì˜ ì¸ìƒ ê²°ë§!</h2>
            <p className="mb-4">ë„ˆì˜ ì„ íƒì´ ëª¨ì—¬ ì´ëŸ° ì´ì•¼ê¸°ê°€ ë˜ì—ˆì–´!</p>
            <ul className="text-left list-disc ml-6 mb-6">
              {Object.entries(stats).map(([k, v]) => (
                <li key={k}>
                  {k}: {v}ì 
                </li>
              ))}
            </ul>
            <Button onClick={() => window.location.reload()}>ë‹¤ì‹œ í•˜ê¸°</Button>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}
